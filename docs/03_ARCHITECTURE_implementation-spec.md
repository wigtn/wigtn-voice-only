# WIGVO êµ¬í˜„ ëª…ì„¸ì„œ (Implementation Specification)

> ì´ ë¬¸ì„œëŠ” ì½”ë“œ êµ¬í˜„ ì „ ì„¤ê³„ ëª…ì„¸ì…ë‹ˆë‹¤. í•´ì»¤í†¤ ë‹¹ì¼ ì´ ëª…ì„¸ë¥¼ ê¸°ë°˜ìœ¼ë¡œ êµ¬í˜„í•©ë‹ˆë‹¤.

---

## 1. ì „ì²´ íŒŒì´í”„ë¼ì¸ íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        WIGVO Pipeline                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚   [1] ì±„íŒ… UI        [2] ì •ë³´ ìˆ˜ì§‘         [3] êµ¬ì¡°í™”              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚  User   â”‚â”€â”€â”€â”€â”€â”€â–¶â”‚  GPT-4o-mini â”‚â”€â”€â”€â”€â”€â”€â–¶â”‚ CollectedDataâ”‚          â”‚
â”‚   â”‚  Input  â”‚       â”‚  Multi-turn  â”‚       â”‚    JSON      â”‚          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                   â”‚                  â”‚
â”‚   [6] ê²°ê³¼ í‘œì‹œ      [5] í†µí™” ì‹¤í–‰         [4] í”„ë¡¬í”„íŠ¸ ìƒì„±        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚ Result  â”‚â—€â”€â”€â”€â”€â”€â”€â”‚  ElevenLabs  â”‚â—€â”€â”€â”€â”€â”€â”€â”‚   Dynamic    â”‚          â”‚
â”‚   â”‚  UI     â”‚       â”‚   + Twilio   â”‚       â”‚   Prompt     â”‚          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Phase 1: GPT ê¸°ë°˜ ì •ë³´ ìˆ˜ì§‘ ì‹œìŠ¤í…œ

### 2.1 System Prompt ì„¤ê³„ ì›ì¹™

GPT-4o-miniì—ê²Œ ì „ë‹¬í•  System PromptëŠ” ë‹¤ìŒ ìš”ì†Œë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤:

#### ì—­í•  ì •ì˜
- AI ë¹„ì„œë¡œì„œ ì‚¬ìš©ìì˜ ì „í™” ìš”ì²­ì— í•„ìš”í•œ ì •ë³´ë¥¼ ëŒ€í™”ë¡œ ìˆ˜ì§‘
- ì¹œê·¼í•˜ê³  ìì—°ìŠ¤ëŸ¬ìš´ í•œêµ­ì–´ í•´ìš”ì²´ ì‚¬ìš©

#### ìˆ˜ì§‘ ëŒ€ìƒ í•„ë“œ (ìš°ì„ ìˆœìœ„)

| ìš°ì„ ìˆœìœ„ | í•„ë“œëª… | ì„¤ëª… | ì˜ˆì‹œ |
|----------|--------|------|------|
| **í•„ìˆ˜** | target_name | ì „í™”í•  ê³³ ì´ë¦„ | "OOë¯¸ìš©ì‹¤" |
| **í•„ìˆ˜** | target_phone | ì „í™”ë²ˆí˜¸ | "010-1234-5678" |
| **í•„ìˆ˜** | scenario_type | ìš©ê±´ ìœ í˜• | RESERVATION / INQUIRY / AS_REQUEST |
| **í•„ìˆ˜** | primary_datetime | í¬ë§ ì¼ì‹œ | "ë‚´ì¼ ì˜¤í›„ 3ì‹œ" |
| ê¶Œì¥ | service | êµ¬ì²´ì  ì„œë¹„ìŠ¤ | "ë‚¨ì ì»¤íŠ¸" |
| ê¶Œì¥ | customer_name | ì˜ˆì•½ì ì´ë¦„ | "í™ê¸¸ë™" |
| ê¶Œì¥ | party_size | ì¸ì›ìˆ˜ | 1 |
| ì„ íƒ | fallback_datetimes | ëŒ€ì•ˆ ì‹œê°„ ëª©ë¡ | ["ë‚´ì¼ 4ì‹œ", "ëª¨ë ˆ 3ì‹œ"] |
| ì„ íƒ | fallback_action | ë¶ˆê°€ ì‹œ ëŒ€ì‘ | ASK_AVAILABLE / NEXT_DAY / CANCEL |
| ì„ íƒ | special_request | íŠ¹ë³„ ìš”ì²­ | "ì°½ê°€ ìë¦¬ë¡œ ë¶€íƒë“œë ¤ìš”" |

#### ëŒ€í™” ê·œì¹™
1. í•œ ë²ˆì— 1-2ê°œ ì§ˆë¬¸ë§Œ (ì‚¬ìš©ì í”¼ë¡œë„ ë°©ì§€)
2. ëª¨í˜¸í•œ ë‹µë³€ì€ ëª…í™•íˆ ì¬í™•ì¸
3. ì •ë³´ê°€ ì¶©ë¶„í•˜ë©´ ìš”ì•½ í›„ í™•ì¸ ìš”ì²­
4. í•„ìˆ˜ 4ê°œ í•„ë“œ ìˆ˜ì§‘ ì™„ë£Œ ì‹œ ì¢…ë£Œ

#### ì‘ë‹µ í˜•ì‹ ê·œì¹™

GPTëŠ” ë§¤ ì‘ë‹µë§ˆë‹¤ **êµ¬ì¡°í™”ëœ JSON**ì„ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤:

```
ì‘ë‹µ êµ¬ì¡°:
- message: ì‚¬ìš©ìì—ê²Œ í‘œì‹œí•  ìì—°ì–´ ë©”ì‹œì§€
- collected: í˜„ì¬ê¹Œì§€ ìˆ˜ì§‘ëœ ëª¨ë“  í•„ë“œ (null í—ˆìš©)
- is_complete: í•„ìˆ˜ ì •ë³´ ìˆ˜ì§‘ ì™„ë£Œ ì—¬ë¶€ (boolean)
```

JSONì€ ë§ˆí¬ë‹¤ìš´ ì½”ë“œ ë¸”ë¡ìœ¼ë¡œ ê°ì‹¸ì„œ íŒŒì‹± ìš©ì´í•˜ê²Œ í•©ë‹ˆë‹¤.

### 2.2 ì‘ë‹µ íŒŒì‹± ì•Œê³ ë¦¬ì¦˜

GPT ì‘ë‹µì—ì„œ JSONì„ ì¶”ì¶œí•˜ëŠ” ë¡œì§:

```
1. ì •ê·œì‹ìœ¼ë¡œ ```json ... ``` ë¸”ë¡ íƒìƒ‰
2. ë¸”ë¡ ë°œê²¬ ì‹œ:
   - JSON.parse ì‹œë„
   - ì„±ê³µ: message, collected, is_complete ì¶”ì¶œ
   - ì‹¤íŒ¨: ì „ì²´ ì‘ë‹µì„ messageë¡œ, ê¸°ë³¸ê°’ ì‚¬ìš©
3. ë¸”ë¡ ë¯¸ë°œê²¬ ì‹œ:
   - ì „ì²´ ì‘ë‹µì„ messageë¡œ ì²˜ë¦¬
   - collectedëŠ” ì´ì „ ìƒíƒœ ìœ ì§€
   - is_completeëŠ” false
```

### 2.3 ìƒíƒœ ê´€ë¦¬ ì „ëµ

ì±„íŒ… ì¤‘ ìˆ˜ì§‘ëœ ë°ì´í„° ëˆ„ì  ë°©ì‹:

```
ì´ˆê¸° ìƒíƒœ: ëª¨ë“  í•„ë“œ null

ë§¤ ì‘ë‹µë§ˆë‹¤:
  1. GPT ì‘ë‹µì˜ collected ê°ì²´ ìˆ˜ì‹ 
  2. ê° í•„ë“œë³„ë¡œ:
     - ìƒˆ ê°’ì´ nullì´ ì•„ë‹ˆë©´ â†’ ì—…ë°ì´íŠ¸
     - ìƒˆ ê°’ì´ nullì´ë©´ â†’ ê¸°ì¡´ ê°’ ìœ ì§€
  3. ë°°ì—´ í•„ë“œ(fallback_datetimes)ëŠ” ë¹„ì–´ìˆì§€ ì•Šì„ ë•Œë§Œ êµì²´
```

### 2.4 ì™„ë£Œ ì¡°ê±´ íŒì •

```
í•„ìˆ˜ í•„ë“œ 4ê°œ ëª¨ë‘ non-null:
  - target_name
  - target_phone
  - scenario_type
  - primary_datetime

AND GPTê°€ is_complete: true ë°˜í™˜

â†’ ì •ë³´ ìˆ˜ì§‘ ì™„ë£Œ, Phase 2ë¡œ ì§„í–‰
```

---

## 3. Phase 2: CollectedData êµ¬ì¡°

### 3.1 íƒ€ì… ì •ì˜

```
CollectedData {
  // í•„ìˆ˜ (Required)
  target_name: string        // ì „í™”í•  ê³³ ì´ë¦„
  target_phone: string       // ì „í™”ë²ˆí˜¸ (ì›ë³¸ í˜•ì‹)
  scenario_type: enum        // RESERVATION | INQUIRY | AS_REQUEST
  primary_datetime: string   // ìì—°ì–´ ì¼ì‹œ í‘œí˜„

  // ê¶Œì¥ (Recommended)
  service: string | null     // êµ¬ì²´ì  ì„œë¹„ìŠ¤ëª…
  customer_name: string | null
  party_size: number | null

  // ì„ íƒ (Optional)
  fallback_datetimes: string[]  // ëŒ€ì•ˆ ì‹œê°„ ëª©ë¡
  fallback_action: enum | null  // ASK_AVAILABLE | NEXT_DAY | CANCEL
  special_request: string | null
}
```

### 3.2 ì‹œë‚˜ë¦¬ì˜¤ íƒ€ì… íŒë³„ ê¸°ì¤€

| í‚¤ì›Œë“œ | ì‹œë‚˜ë¦¬ì˜¤ |
|--------|----------|
| ì˜ˆì•½, ì˜ˆë§¤, ë¶€í‚¹, ì¡ì•„ì¤˜ | RESERVATION |
| ë¬¸ì˜, í™•ì¸, ì•Œì•„ë´ì¤˜, ë¬¼ì–´ë´ì¤˜ | INQUIRY |
| AS, ìˆ˜ë¦¬, ê³ ì¥, ì ‘ìˆ˜ | AS_REQUEST |

GPTê°€ ëŒ€í™” ë§¥ë½ì—ì„œ ìë™ íŒë³„í•˜ë„ë¡ System Promptì— ëª…ì‹œí•©ë‹ˆë‹¤.

---

## 4. Phase 3: Dynamic Prompt ìƒì„±

### 4.1 ì„¤ê³„ ì›ì¹™

ElevenLabs Agentì—ê²Œ ì „ë‹¬í•  System PromptëŠ”:
- **CollectedData ê¸°ë°˜ìœ¼ë¡œ ë™ì  ìƒì„±**
- ì‹œë‚˜ë¦¬ì˜¤ íƒ€ì…ë³„ í…œí”Œë¦¿ ì‚¬ìš©
- ìì—°ìŠ¤ëŸ¬ìš´ í•œêµ­ì–´ ëŒ€í™” íë¦„ í¬í•¨
- Fallback ì „ëµ ëª…ì‹œ

### 4.2 ì‹œë‚˜ë¦¬ì˜¤ë³„ í”„ë¡¬í”„íŠ¸ êµ¬ì¡°

#### RESERVATION (ì˜ˆì•½)

```
êµ¬ì¡°:
1. ì—­í•  ì •ì˜: "ê³ ê°ì„ ëŒ€ì‹ í•´ {target_name}ì— ì „í™”ë¥¼ ê±°ëŠ” AI ë¹„ì„œ"

2. ëª©í‘œ: "{primary_datetime}ì— {service} ì˜ˆì•½ ìš”ì²­"

3. ì˜ˆì•½ ì •ë³´ ì„¹ì…˜:
   - ì¥ì†Œ, í¬ë§ ì¼ì‹œ, ì„œë¹„ìŠ¤, ì˜ˆì•½ì, ì¸ì›

4. ëŒ€í™” íë¦„:
   Step 1: ì¸ì‚¬ ("ì•ˆë…•í•˜ì„¸ìš”, ì˜ˆì•½ ë¬¸ì˜ ë“œë¦½ë‹ˆë‹¤")
   Step 2: ìš”ì²­ ("{datetime}ì— {service} ì˜ˆì•½ ê°€ëŠ¥í• ê¹Œìš”?")
   Step 3-ê°€ëŠ¥: ì˜ˆì•½ í™•ì • ("{customer_name} ì´ë¦„ìœ¼ë¡œ ì˜ˆì•½")
   Step 3-ë¶ˆê°€: Fallback ì „ëµ ì‹¤í–‰
   Step 4: ë§ˆë¬´ë¦¬ ì¸ì‚¬

5. Fallback ì „ëµ (fallback_actionì— ë”°ë¼):
   - ASK_AVAILABLE: "ê·¸ëŸ¼ ì–¸ì œ ê°€ëŠ¥í•œì§€ ì•Œë ¤ì£¼ì‹œê² ì–´ìš”?"
   - NEXT_DAY: "{fallback_datetimes}ì€ ì–´ë–¤ì§€" ì œì•ˆ
   - CANCEL: ì •ì¤‘íˆ ì¢…ë£Œ

6. ê·œì¹™:
   - í•´ìš”ì²´ ì‚¬ìš©
   - ì˜ˆì•½ í™•ì • ì‹œ ì¼ì‹œ+ì´ë¦„ ì¬í™•ì¸
   - ëª» ì•Œì•„ë“¤ìœ¼ë©´ ì²œì²œíˆ ë°˜ë³µ
```

#### INQUIRY (ë¬¸ì˜)

```
êµ¬ì¡°:
1. ì—­í•  ì •ì˜: ë™ì¼

2. ëª©í‘œ: "{service}ì— ëŒ€í•´ ë¬¸ì˜"

3. ë¬¸ì˜ ë‚´ìš©: {special_request}

4. ëŒ€í™” íë¦„:
   Step 1: ì¸ì‚¬ ("ë¬¸ì˜ ë“œë¦´ ê²Œ ìˆì–´ì„œ ì „í™”ë“œë ¸ìŠµë‹ˆë‹¤")
   Step 2: ì§ˆë¬¸ ì „ë‹¬
   Step 3: ë‹µë³€ ê²½ì²­ + ì¶”ê°€ ì§ˆë¬¸
   Step 4: ê°ì‚¬ ì¸ì‚¬

5. ê·œì¹™: ì¤‘ìš” ì •ë³´ ì¬í™•ì¸
```

#### AS_REQUEST (AS/ìˆ˜ë¦¬ ì ‘ìˆ˜)

```
êµ¬ì¡°:
1. ì—­í•  ì •ì˜: ë™ì¼

2. ëª©í‘œ: "{service} AS/ìˆ˜ë¦¬ ì ‘ìˆ˜ ìš”ì²­"

3. ì ‘ìˆ˜ ì •ë³´:
   - ì—…ì²´, í¬ë§ ë°©ë¬¸ì¼, ì„œë¹„ìŠ¤, ê³ ê°ëª…, ì¦ìƒ

4. ëŒ€í™” íë¦„:
   Step 1: ì¸ì‚¬ ("AS ì ‘ìˆ˜ ë¬¸ì˜ ë“œë¦½ë‹ˆë‹¤")
   Step 2: ì¦ìƒ ì„¤ëª… ("{service}ê°€ {special_request} ìƒíƒœ")
   Step 3: ì¼ì • ì¡°ìœ¨
   Step 4: ì ‘ìˆ˜ í™•ì •

5. ê·œì¹™: ë°©ë¬¸ ì¼ì • + ì˜ˆìƒ ë¹„ìš© í™•ì¸
```

### 4.3 Dynamic Variables ë§¤í•‘

ElevenLabs APIì— ì „ë‹¬í•  ë³€ìˆ˜:

| CollectedData í•„ë“œ | Dynamic Variable | ìš©ë„ |
|-------------------|------------------|------|
| target_name | target_name | ì—…ì²´ëª… í˜¸ì¹­ |
| primary_datetime | datetime | ì¼ì‹œ ì–¸ê¸‰ |
| service | service | ì„œë¹„ìŠ¤ëª… |
| customer_name | customer_name | ì˜ˆì•½ìëª… |
| party_size | party_size | ì¸ì› (ë¬¸ìì—´ ë³€í™˜) |
| special_request | question / issue | ë¬¸ì˜ ë‚´ìš© ë˜ëŠ” ì¦ìƒ |

---

## 5. Phase 4: ElevenLabs ì „í™” ë°œì‹ 

### 5.1 API ì—”ë“œí¬ì¸íŠ¸

```
POST https://api.elevenlabs.io/v1/convai/twilio/outbound-call
```

### 5.2 ìš”ì²­ í˜ì´ë¡œë“œ êµ¬ì¡°

```
{
  agent_id: í™˜ê²½ë³€ìˆ˜ì—ì„œ ë¡œë“œ,
  agent_phone_number_id: í™˜ê²½ë³€ìˆ˜ì—ì„œ ë¡œë“œ,
  to_number: E.164 í˜•ì‹ ì „í™”ë²ˆí˜¸,
  conversation_initiation_client_data: {
    dynamic_variables: {
      // Phase 3ì—ì„œ ìƒì„±í•œ ë³€ìˆ˜ë“¤
    }
  }
}
```

### 5.3 ì „í™”ë²ˆí˜¸ í¬ë§·íŒ… ê·œì¹™

í•œêµ­ ì „í™”ë²ˆí˜¸ â†’ E.164 ë³€í™˜:

```
ì…ë ¥                    ì¶œë ¥
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
010-1234-5678          +821012345678
01012345678            +821012345678
02-123-4567            +8221234567
+821012345678          +821012345678 (ìœ ì§€)
```

**ì „í™”ë²ˆí˜¸ í¬ë§·íŒ… (5íŒ¨í„´):**

| ì…ë ¥ | ì¶œë ¥ | ì„¤ëª… |
|------|------|------|
| `010-1234-5678` | `+821012345678` | íœ´ëŒ€í° (í•˜ì´í”ˆ í¬í•¨) |
| `01012345678` | `+821012345678` | íœ´ëŒ€í° (í•˜ì´í”ˆ ì—†ìŒ) |
| `02-123-4567` | `+8221234567` | ì„œìš¸ ì§€ì—­ë²ˆí˜¸ |
| `031-123-4567` | `+82311234567` | ê²½ê¸° ì§€ì—­ë²ˆí˜¸ |
| `+821012345678` | `+821012345678` | ì´ë¯¸ E.164 í˜•ì‹ (ìœ ì§€) |

ë³€í™˜ ì•Œê³ ë¦¬ì¦˜:
1. ìˆ«ìì™€ + ì™¸ ë¬¸ì ì œê±°
2. +ë¡œ ì‹œì‘í•˜ë©´ ê·¸ëŒ€ë¡œ ë°˜í™˜
3. 0ìœ¼ë¡œ ì‹œì‘í•˜ë©´ 0 ì œê±° í›„ +82 ë¶™ì´ê¸°
4. ê·¸ ì™¸ +82 + ì „ì²´

### 5.4 ì‘ë‹µ ì²˜ë¦¬

ì„±ê³µ ì‹œ:
```
{
  conversation_id: "conv_xxx"  // í†µí™” ì¶”ì ìš© ID
}
```

ì´ IDë¡œ í†µí™” ìƒíƒœë¥¼ í´ë§í•©ë‹ˆë‹¤.

---

## 6. Phase 5: í†µí™” ê²°ê³¼ í´ë§

### 6.1 ìƒíƒœ ì¡°íšŒ API

```
GET https://api.elevenlabs.io/v1/convai/conversations/{conversation_id}
```

### 6.2 í´ë§ ì „ëµ

```
ì„¤ì •:
- í´ë§ ê°„ê²©: 3ì´ˆ
- ìµœëŒ€ í´ë§ íšŸìˆ˜: 60íšŒ (= 3ë¶„)
- ì—°ì† ì—ëŸ¬ í—ˆìš©: 5íšŒ (5íšŒ ì—°ì† API ì—ëŸ¬ ì‹œ ì¦‰ì‹œ ì¤‘ë‹¨)
- íƒ€ì„ì•„ì›ƒ ì‹œ: FAILED ì²˜ë¦¬
```

### 6.3 ElevenLabs Terminal Status

ElevenLabs conversationì´ ì¢…ë£Œë˜ì—ˆì„ ë•Œ ê°€ëŠ¥í•œ status ê°’:

| ElevenLabs Status | ì˜ë¯¸ | WIGVO ë§¤í•‘ |
|-------------------|------|-----------|
| `completed` | ì •ìƒ ì¢…ë£Œ | â†’ ê²°ê³¼ íŒì • ì•Œê³ ë¦¬ì¦˜ ì‹¤í–‰ |
| `failed` | í†µí™” ì‹¤íŒ¨ | â†’ FAILED + ERROR |
| `ended` | ìƒëŒ€ë°©ì´ ëŠìŒ | â†’ ê²°ê³¼ íŒì • ì•Œê³ ë¦¬ì¦˜ ì‹¤í–‰ |
| `terminated` | ì‹œìŠ¤í…œ ì¢…ë£Œ | â†’ FAILED + ERROR |

> `completed`ì™€ `ended`ë§Œ ì„±ê³µ ê°€ëŠ¥. `failed`ì™€ `terminated`ëŠ” ë¬´ì¡°ê±´ ì‹¤íŒ¨.

### 6.4 ê²°ê³¼ íŒì • ì•Œê³ ë¦¬ì¦˜

í†µí™” ì¢…ë£Œ í›„ ê²°ê³¼(SUCCESS/NO_ANSWER/REJECTED/ERROR)ë¥¼ íŒì •í•˜ëŠ” 7ë‹¨ê³„ ìš°ì„ ìˆœìœ„:

1. ElevenLabs statusê°€ `failed` ë˜ëŠ” `terminated` â†’ **ERROR**
2. `analysis.data_collection_results`ì— result í•„ë“œ ì¡´ì¬ â†’ í•´ë‹¹ ê°’ ì‚¬ìš©
3. `analysis.transcript_summary`ì— ì„±ê³µ í‚¤ì›Œë“œ ("ì˜ˆì•½ ì™„ë£Œ", "í™•ì¸") â†’ **SUCCESS**
4. transcript_summaryì— ê±°ì ˆ í‚¤ì›Œë“œ ("ê±°ì ˆ", "ë¶ˆê°€", "ì•ˆ ë©ë‹ˆë‹¤") â†’ **REJECTED**
5. transcript_summaryì— ë¶€ì¬ í‚¤ì›Œë“œ ("ë¶€ì¬", "ë°›ì§€ ì•Š", "ì—°ê²°ë˜ì§€") â†’ **NO_ANSWER**
6. transcriptê°€ ë¹„ì–´ìˆê±°ë‚˜ ë§¤ìš° ì§§ìŒ (3í„´ ë¯¸ë§Œ) â†’ **NO_ANSWER**
7. ìœ„ ì–´ëŠ ê²ƒì—ë„ í•´ë‹¹í•˜ì§€ ì•Šìœ¼ë©´ â†’ **SUCCESS** (ê¸°ë³¸ê°’)

### 6.5 ê²°ê³¼ ë°ì´í„° êµ¬ì¡°

í†µí™” ì™„ë£Œ ì‹œ ElevenLabs ì‘ë‹µ:

```
{
  status: "done",
  analysis: {
    transcript_summary: "í†µí™” ìš”ì•½ í…ìŠ¤íŠ¸",
    data_collection_results: { ... }
  }
}
```

### 6.6 Conversation Update ì‹¤íŒ¨ ì‹œ ì²˜ë¦¬

í†µí™” ê²°ê³¼ë¥¼ DBì— ì €ì¥í•  ë•Œ (calls + conversations ìƒíƒœ ì—…ë°ì´íŠ¸):
- calls ì—…ë°ì´íŠ¸ê°€ ì„±ê³µí•˜ê³  conversations ì—…ë°ì´íŠ¸ê°€ ì‹¤íŒ¨í•´ë„ **calls ê²°ê³¼ëŠ” ìœ ì§€**
- conversations ì—…ë°ì´íŠ¸ ì‹¤íŒ¨ëŠ” ë¡œê·¸ì— ê¸°ë¡í•˜ë˜ ì „ì²´ íë¦„ì„ ì¤‘ë‹¨í•˜ì§€ ì•ŠìŒ
- í”„ë¡ íŠ¸ì—”ë“œëŠ” calls ìƒíƒœë§Œ í´ë§í•˜ë¯€ë¡œ conversations ì—…ë°ì´íŠ¸ ì‹¤íŒ¨ëŠ” UXì— ì˜í–¥ ì—†ìŒ

---

## 7. ì—ëŸ¬ ì²˜ë¦¬ ì „ëµ

### 7.1 GPT API ì—ëŸ¬

| ì—ëŸ¬ | ëŒ€ì‘ |
|------|------|
| Rate limit | 2ì´ˆ í›„ ì¬ì‹œë„ (ìµœëŒ€ 3íšŒ) |
| Invalid API key | ì‚¬ìš©ìì—ê²Œ ì„¤ì • í™•ì¸ ìš”ì²­ |
| Timeout | ì¬ì‹œë„ ë˜ëŠ” ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼ |

### 7.2 ElevenLabs API ì—ëŸ¬

| ì—ëŸ¬ | ëŒ€ì‘ |
|------|------|
| Invalid phone number | ë²ˆí˜¸ í˜•ì‹ ì¬í™•ì¸ ìš”ì²­ |
| Agent not found | í™˜ê²½ë³€ìˆ˜ í™•ì¸ |
| Quota exceeded | ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼ |

### 7.3 JSON íŒŒì‹± ì—ëŸ¬

GPT ì‘ë‹µì´ ì˜ˆìƒ í˜•ì‹ì´ ì•„ë‹ ë•Œ:
1. ì „ì²´ ì‘ë‹µì„ messageë¡œ í‘œì‹œ
2. collectedëŠ” ì´ì „ ìƒíƒœ ìœ ì§€
3. ë¡œê·¸ì— ì›ë³¸ ì‘ë‹µ ê¸°ë¡
4. ëŒ€í™” ê³„ì† ì§„í–‰ (ì¤‘ë‹¨í•˜ì§€ ì•ŠìŒ)

---

## 8. UI/UX ëª…ì„¸

### 8.1 ì±„íŒ… í™”ë©´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  WIGVO - AI ì „í™” ë¹„ì„œ              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                    â”‚
â”‚  ğŸ¤– ì•ˆë…•í•˜ì„¸ìš”! ì–´ë–¤ ì „í™”ë¥¼        â”‚
â”‚     ëŒ€ì‹  ê±¸ì–´ë“œë¦´ê¹Œìš”?             â”‚
â”‚                                    â”‚
â”‚                    ë¯¸ìš©ì‹¤ ì˜ˆì•½ ğŸ‘¤  â”‚
â”‚                    í•˜ê³  ì‹¶ì–´ìš”     â”‚
â”‚                                    â”‚
â”‚  ğŸ¤– ì–´ëŠ ë¯¸ìš©ì‹¤ì¸ê°€ìš”?             â”‚
â”‚     ì „í™”ë²ˆí˜¸ë„ ì•Œë ¤ì£¼ì„¸ìš”!         â”‚
â”‚                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ë©”ì‹œì§€ ì…ë ¥...]           [ì „ì†¡] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 í™•ì¸ í™”ë©´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“‹ ìˆ˜ì§‘ëœ ì •ë³´                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ì¥ì†Œ: OOë¯¸ìš©ì‹¤                    â”‚
â”‚  ì „í™”: 010-1234-5678               â”‚
â”‚  ì¼ì‹œ: ë‚´ì¼ ì˜¤í›„ 3ì‹œ               â”‚
â”‚  ì„œë¹„ìŠ¤: ë‚¨ì ì»¤íŠ¸                 â”‚
â”‚  ì˜ˆì•½ì: í™ê¸¸ë™                    â”‚
â”‚  ì¸ì›: 1ëª…                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ ìˆ˜ì •í•˜ê¸° ]    [ ì „í™” ê±¸ê¸° ğŸ“ ]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.3 í†µí™” ì¤‘ í™”ë©´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    â”‚
â”‚         ğŸ“ í†µí™” ì¤‘...              â”‚
â”‚                                    â”‚
â”‚      OOë¯¸ìš©ì‹¤ì— ì „í™”í•˜ê³  ìˆì–´ìš”    â”‚
â”‚                                    â”‚
â”‚          â±ï¸ 00:32                  â”‚
â”‚                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚  ğŸ’¡ AIê°€ ì˜ˆì•½ì„ ì§„í–‰í•˜ê³  ìˆìŠµë‹ˆë‹¤  â”‚
â”‚     ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”            â”‚
â”‚                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.4 ê²°ê³¼ í™”ë©´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… ì˜ˆì•½ ì™„ë£Œ!                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                    â”‚
â”‚  OOë¯¸ìš©ì‹¤                          â”‚
â”‚  ğŸ“… ë‚´ì¼ ì˜¤í›„ 3ì‹œ                  â”‚
â”‚  âœ‚ï¸ ë‚¨ì ì»¤íŠ¸                      â”‚
â”‚  ğŸ‘¤ í™ê¸¸ë™                         â”‚
â”‚                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚  ğŸ“ í†µí™” ìš”ì•½                      â”‚
â”‚  "ë‚´ì¼ ì˜¤í›„ 3ì‹œ ë‚¨ì ì»¤íŠ¸ ì˜ˆì•½ì´   â”‚
â”‚   í™ê¸¸ë™ ì´ë¦„ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤"  â”‚
â”‚                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ ìƒˆ ì „í™” ê±¸ê¸° ]  [ ê¸°ë¡ ë³´ê¸° ]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 9. íŒŒì¼ êµ¬ì¡° (êµ¬í˜„ ì‹œ ìƒì„±)

```
app/
â”œâ”€â”€ page.tsx                    # ë©”ì¸ ì±„íŒ… í˜ì´ì§€
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ conversations/
â”‚   â”‚   â””â”€â”€ route.ts            # ëŒ€í™” ì‹œì‘ API
â”‚   â”œâ”€â”€ chat/
â”‚   â”‚   â””â”€â”€ route.ts            # ë©”ì‹œì§€ ì „ì†¡ API (GPT í˜¸ì¶œ)
â”‚   â””â”€â”€ calls/
â”‚       â”œâ”€â”€ route.ts            # ì „í™” ë°œì‹  API
â”‚       â””â”€â”€ [id]/
â”‚           â””â”€â”€ route.ts        # í†µí™” ìƒíƒœ ì¡°íšŒ API

components/
â”œâ”€â”€ chat/
â”‚   â”œâ”€â”€ ChatContainer.tsx       # ì±„íŒ… ì „ì²´ ì»¨í…Œì´ë„ˆ
â”‚   â”œâ”€â”€ ChatMessage.tsx         # ê°œë³„ ë©”ì‹œì§€ ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ ChatInput.tsx           # ë©”ì‹œì§€ ì…ë ¥ì°½
â”‚   â””â”€â”€ CollectionSummary.tsx   # ìˆ˜ì§‘ ì •ë³´ ìš”ì•½ ì¹´ë“œ
â”œâ”€â”€ call/
â”‚   â”œâ”€â”€ CallProgress.tsx        # í†µí™” ì¤‘ í™”ë©´
â”‚   â””â”€â”€ CallResult.tsx          # í†µí™” ê²°ê³¼ í™”ë©´

lib/
â”œâ”€â”€ supabase/
â”‚   â”œâ”€â”€ client.ts               # ë¸Œë¼ìš°ì €ìš© Supabase í´ë¼ì´ì–¸íŠ¸
â”‚   â””â”€â”€ server.ts               # ì„œë²„ìš© Supabase í´ë¼ì´ì–¸íŠ¸
â”œâ”€â”€ prompts.ts                  # GPT System Prompt ìƒìˆ˜
â”œâ”€â”€ response-parser.ts          # GPT ì‘ë‹µ JSON íŒŒì‹±
â”œâ”€â”€ prompt-generator.ts         # Dynamic Prompt ìƒì„±ê¸°
â””â”€â”€ phone-formatter.ts          # ì „í™”ë²ˆí˜¸ E.164 ë³€í™˜

hooks/
â””â”€â”€ useChat.ts                  # ì±„íŒ… ìƒíƒœ ê´€ë¦¬ í›…

types/
â”œâ”€â”€ collected-data.ts           # CollectedData íƒ€ì…
â””â”€â”€ database.ts                 # Supabase í…Œì´ë¸” íƒ€ì…
```

---

## 10. API ì—”ë“œí¬ì¸íŠ¸ ëª…ì„¸

### POST /api/conversations

ëŒ€í™” ì„¸ì…˜ ì‹œì‘

**Request:** ì—†ìŒ (ìƒˆ ì„¸ì…˜ ìƒì„±)

**Response:**
```
{
  id: "uuid",
  status: "COLLECTING",
  initial_message: "ì•ˆë…•í•˜ì„¸ìš”! ì–´ë–¤ ì „í™”ë¥¼ ëŒ€ì‹  ê±¸ì–´ë“œë¦´ê¹Œìš”?"
}
```

### POST /api/chat

ë©”ì‹œì§€ ì „ì†¡ ë° GPT ì‘ë‹µ

**Request:**
```
{
  conversation_id: "uuid",
  message: "ë¯¸ìš©ì‹¤ ì˜ˆì•½í•˜ê³  ì‹¶ì–´ìš”"
}
```

**Response:**
```
{
  message: "ì–´ëŠ ë¯¸ìš©ì‹¤ì¸ê°€ìš”?",
  collected: { ... },
  is_complete: false
}
```

### POST /api/calls

ì „í™” ë°œì‹  ì‹œì‘

**Request:**
```
{
  conversation_id: "uuid"
}
```

**Response:**
```
{
  call_id: "uuid",
  elevenlabs_conversation_id: "conv_xxx",
  status: "IN_PROGRESS"
}
```

### GET /api/calls/[id]

í†µí™” ìƒíƒœ ì¡°íšŒ

**Response:**
```
{
  id: "uuid",
  status: "COMPLETED",
  result_summary: "ì˜ˆì•½ ì™„ë£Œ",
  transcript_summary: "..."
}
```

---

## 11. í™˜ê²½ë³€ìˆ˜

| ë³€ìˆ˜ | ìš©ë„ | í•„ìˆ˜ |
|------|------|------|
| NEXT_PUBLIC_SUPABASE_URL | Supabase í”„ë¡œì íŠ¸ URL | âœ… |
| NEXT_PUBLIC_SUPABASE_ANON_KEY | Supabase anon key | âœ… |
| OPENAI_API_KEY | GPT API í‚¤ | âœ… |
| ELEVENLABS_API_KEY | ElevenLabs API í‚¤ | âœ… |
| ELEVENLABS_AGENT_ID | ElevenLabs Agent ID | âœ… |
| ELEVENLABS_PHONE_NUMBER_ID | Twilio ë²ˆí˜¸ ID | âœ… |

---

## 12. êµ¬í˜„ ìš°ì„ ìˆœìœ„

### P0 (ë°ëª¨ í•„ìˆ˜)
1. ì±„íŒ… UI + GPT ì—°ë™
2. CollectedData ìˆ˜ì§‘ ë° í‘œì‹œ
3. ElevenLabs ì „í™” ë°œì‹ 
4. ê²°ê³¼ í™”ë©´

### P1 (ì™„ì„±ë„)
1. Supabase ì €ì¥
2. í†µí™” ê¸°ë¡ ëª©ë¡
3. ì—ëŸ¬ ì²˜ë¦¬ UI

### P2 (ìˆìœ¼ë©´ ì¢‹ìŒ)
1. ì†Œì…œ ë¡œê·¸ì¸
2. í†µí™” ë…¹ìŒ ì¬ìƒ
3. ë°˜ë³µ ì˜ˆì•½

---

## 13. Database ER Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Database Schema                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    conversations    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id          UUID PK â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ user_id     UUID FK â”‚                       â”‚
â”‚ status      TEXT    â”‚                       â”‚
â”‚ collected_data JSONBâ”‚                       â”‚
â”‚ created_at  TIMESTAMPTZ                     â”‚
â”‚ updated_at  TIMESTAMPTZ                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
         â”‚                                    â”‚
         â”‚ 1:N                                â”‚ 1:1
         â–¼                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      messages       â”‚              â”‚       calls         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id          UUID PK â”‚              â”‚ id          UUID PK â”‚
â”‚ conversation_id  FK â”‚              â”‚ conversation_id  FK â”‚
â”‚ role        TEXT    â”‚              â”‚ user_id     UUID FK â”‚
â”‚ content     TEXT    â”‚              â”‚ target_phone   TEXT â”‚
â”‚ metadata    JSONB   â”‚              â”‚ target_name    TEXT â”‚
â”‚ created_at  TIMESTAMPTZ            â”‚ status         TEXT â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚ elevenlabs_conv_id  â”‚
                                     â”‚ result       JSONB  â”‚
                                     â”‚ result_summary TEXT â”‚
                                     â”‚ created_at  TIMESTAMPTZ
                                     â”‚ updated_at  TIMESTAMPTZ
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 13.1 Status ê°’

**conversations.status:**
```
COLLECTING  â†’ ì •ë³´ ìˆ˜ì§‘ ì¤‘
READY       â†’ ìˆ˜ì§‘ ì™„ë£Œ, ì „í™” ëŒ€ê¸°
CALLING     â†’ ì „í™” ì¤‘
COMPLETED   â†’ ì™„ë£Œ
CANCELLED   â†’ ì·¨ì†Œë¨
```

**calls.status:**
```
PENDING     â†’ ëŒ€ê¸°
CALLING     â†’ ë°œì‹  ì¤‘
IN_PROGRESS â†’ í†µí™” ì¤‘
COMPLETED   â†’ ì™„ë£Œ
FAILED      â†’ ì‹¤íŒ¨
```

### 13.2 JSONB í•„ë“œ êµ¬ì¡°

**collected_data:**
```json
{
  "target_name": "OOë¯¸ìš©ì‹¤",
  "target_phone": "010-1234-5678",
  "scenario_type": "RESERVATION",
  "primary_datetime": "ë‚´ì¼ ì˜¤í›„ 3ì‹œ",
  "service": "ë‚¨ì ì»¤íŠ¸",
  "fallback_datetimes": ["4ì‹œ", "5ì‹œ"],
  "fallback_action": "ASK_AVAILABLE",
  "customer_name": "í™ê¸¸ë™",
  "party_size": 1,
  "special_request": null
}
```

**result:**
```json
{
  "status": "done",
  "transcript_summary": "ì˜ˆì•½ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤...",
  "confirmed_datetime": "ë‚´ì¼ ì˜¤í›„ 3ì‹œ ë°˜",
  "additional_info": null
}
```

### 13.3 SQL ìŠ¤í‚¤ë§ˆ

SQL ìŠ¤í‚¤ë§ˆëŠ” `scripts/supabase-tables.sql` íŒŒì¼ì— ì •ì˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

---

*ì´ ëª…ì„¸ì„œëŠ” êµ¬í˜„ ê°€ì´ë“œì´ë©°, ì‹¤ì œ ì½”ë“œëŠ” í•´ì»¤í†¤ ë‹¹ì¼ ì‘ì„±í•©ë‹ˆë‹¤.*
